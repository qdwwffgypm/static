!function(a,b){"undefined"!=typeof module?module.exports=b(a):(b(a),"function"==typeof define&&(define.amd||define.cmd)&&define("validate",function(){return b(a)}))}(window||this,function(win){function validate(a,b){return{pageIsValid:function(b){var e,f,c=this,d=!0;for(e in a)if(a.hasOwnProperty(e)&&(f=c.oneIsValid(e),!f.isValid&&d&&(d=!!f.isValid),!f.isValid&&b&&1==b(f.onError,e)))break;return d},oneIsValid:function(c){var d,e,f,g="inputValid",h=b[c];return h?(h.validtype=h.validtype||g,e=a[c]||"",f=a[h.desID]||"",d=__validtype[h.validtype]||__validtype[g],"compareType"==h.validtype?d(e,f,h):d(e,h)):{isValid:!0}}}}var get,_typeof,extend,isTime,isDate,isDateTime,each,getLength,__validtype;return!win.CY&&(win.CY={}),win.CY.validate?win.CY.validate:(get=function(a,b){return a&&a instanceof Object?a:a?(b||document).querySelector(a):null},_typeof=function(a){return Object.prototype.toString.call(a).split(/\s(\w+)/)[1].toLowerCase()},extend=function(a,b){for(var c in b)b.hasOwnProperty(c)&&("object"==_typeof(b[c])?a[c]=extend(a[c]||{},b[c]):"array"==_typeof(b[c])?a[c]=extend(a[c]||[],b[c]):void 0!=b[c]&&(a[c]=b[c]));return a},isTime=function(a){var b=a.match(/^(\d{1,2})(:)?(\d{1,2})\2(\d{1,2})$/);return null==b?!1:b[1]>24||b[3]>60||b[4]>60?!1:!0},isDate=function(a){var c,b=a.match(/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/);return null==b?!1:(c=new Date(b[1],b[3]-1,b[4]),c.getFullYear()==b[1]&&c.getMonth()+1==b[3]&&c.getDate()==b[4])},isDateTime=function(a){var d,b=/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})$/,c=a.match(b);return null==c?!1:(d=new Date(c[1],c[3]-1,c[4],c[5],c[6],c[7]),d.getFullYear()==c[1]&&d.getMonth()+1==c[3]&&d.getDate()==c[4]&&d.getHours()==c[5]&&d.getMinutes()==c[6]&&d.getSeconds()==c[7])},each=function(a,b){a=a||[];for(var c=0,d=a.length;d>c&&0!=b.call(a[c],c,a[c]);c++);},getLength=function(a,b){var e,c=0,d=a||"";if(b)for(e=0;e<d.length;e++)c+=d.charCodeAt(e)>=19968&&d.charCodeAt(e)<=40869?2:1;else c=d.length;return c},__validtype={inputValid:function(a,b){var e,c=extend({type:"size",empty:{leftEmpty:!0,rightEmpty:!0,emptyError:"输入内容为空"},min:0,max:99999999999999,onError:"输入错误",onErrorMin:"",onErrorMax:"",wideWord:!0},b||{}),d={isValid:!0},f=getLength(a,c.wideWord),g=c.empty,h=!1,i=c.type||"size";return"size"==i&&(g=c.empty,g.leftEmpty||(h=a.replace(/^[\s]+/,"").length!=a.length),h||g.rightEmpty||(h=a.replace(/[\s]+$/,"").length!=a.length),h&&g.emptyError&&(d.onError=g.emptyError)),"size"==i?(h||(e=!0),"array"==_typeof(a)&&(f=value.length),e&&(a=f)):"date"==i||"datetime"==i?("date"==i&&(e=isDate(a)),"datetime"==i&&(e=isDateTime(a)),e&&(a=new Date(a),c.min=new Date(c.min),c.max=new Date(c.max))):(type=_typeof(c.min),"number"==type&&(a=new Number(a).valueOf(),isNaN(a)||(e=!0)),"string"==type&&(e=!0)),d.isValid=!1,e&&(a<c.min||a>c.max?(a<c.min&&c.onErrorMin&&(d.onError=c.onErrorMin),a>c.min&&c.onErrorMax&&(d.onError=c.onErrorMax),!d.onError&&(d.onError=c.onError)):d.isValid=!0),d},regType:function(val,params){var i,reg,dataType,setting=extend({param:"",regExp:"",dataType:"string",operateor:"",onError:"输入错误",validtype:"regType"},params||{}),returnObj={isValid:!0},isValid=!1,regExp=setting.regExp;for("array"!=_typeof(regExp)&&(regExp=[regExp]),i=0;i<regExp.length&&(reg=regExp[i],"enum"==dataType&&(reg=eval("regexEnum."+reg)),reg&&""!=val);i++){if(isValid=new RegExp(reg,setting.param).test(val),"||"==setting.operateor&&isValid){isValid=!0;break}if("&&"==setting.operateor&&!isValid)break}return returnObj.onError=setting.onError,returnObj.isValid=isValid,returnObj},funType:function(a,b){var c=extend({fun:function(){},onError:"输入错误"},b||{}),d={isValid:!0},e=c.fun.call(a,a);return 0==e&&(d.isValid=!1,d.onError=c.onError),e&&"string"==_typeof(e)&&(d.isValid=!1,d.onError=e),d},compareType:function(a,b,c){var i,d=extend({desID:"",operateor:"=",onError:"输入错误",dataType:"string"},c||{}),e=d.dataType,f=b||"",g=d.onError,h={isValid:!0};switch("number"==e&&(isNaN(a)||isNaN(f)||(a=parseFloat(a),f=parseFloat(f))),("date"==e||"datetime"==e)&&(i=!1,"date"==e&&(i=isDate(a)&&isDate(f)),"datetime"==e&&(i=isDateTime(a)&&isDateTime(f)),i&&(a=new Date(a).getTime(),f=new Date(f).getTime())),d.operateor){case"=":h.isValid=a==f;break;case"!=":h.isValid=a!=f;break;case">":h.isValid=a>f;break;case">=":h.isValid=a>=f;break;case"<":h.isValid=f>a;break;case"<=":h.isValid=f>=a;break;default:h.isValid=!1}return h.onError=g,h}},validate.addRule=function(a,b){__validtype[a]=b},validate.serialize=function(a){var b=[];return each(this.serializeArray(a),function(a,c){b.push(c.name+"="+c.value)}),b.join("&")},validate.serializeArray=function(a){var b=[],d=[],e=[],f=[],c="object"==_typeof(a)?a:get(a);return c?(d=c.getElementsByTagName("input")||[],e=c.getElementsByTagName("select")||[],f=c.getElementsByTagName("textarea")||[],each(d,function(a,c){var d,e=c.type;!c.name||c.disabled||/button|submit|reset/.test(e)||(/radio|checkbox/.test(e)?c.checked&&(d=c.value):d=c.value,void 0!=d&&b.push({name:c.name,value:d}))}),each(e,function(a,c){c.name&&!c.disabled&&each(this.options,function(a,d){1==d.selected&&b.push({name:c.name,value:d.value})})}),each(f,function(a,c){c.name&&!c.disabled&&b.push({name:c.name,value:c.value})}),b):b},win.CY.validate=validate,validate)});