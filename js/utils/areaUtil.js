"use strict";!function(t,e){"undefined"!=typeof module?module.exports=e(t):(e(t),"function"==typeof define&&(define.amd||define.cmd)&&define("areaUtil",function(){return e(t)}))}(window||void 0,function(t){function e(t,e){var i=[],h=[],x=[];if(t=r(t)){e=e||{},e=o({data:[],drag:.2,items:[],attr:"top",text:"text",value:"value",defaultText:"请选择省市区",moveInt:!0,isSpring:!0},e||{}),e.items.forEach(function(t,n){e.items[n]=o(o({},W),t)});var y,w,S,C,P,H,j=M(e.items),L=X(e.items);P=g("div",{innerHTML:f,className:"areaSelect"}),y=g("div",{innerHTML:s,className:"l-area",style:{display:"none"}}),v(),c(t),H=P.querySelector(".areaInp"),t.parentNode.insertBefore(P,t),n.body.appendChild(y),S=r(".l-cancel",y),C=r(".l-submit",y),w=r(".l-body",y),e.elem=w;var D=new b(e),N=D.__params;a(P,"click",function(){U.show()}),a(S,"click",function(){B(),U.hide(),F(z)}),a(C,"click",function(){A(),_(),U.hide(),x.forEach(function(t){t()})});var O=function(t){var a=t.index,r=[],i=(n.documentElement.clientWidth,Math.floor(100/(a+1))+"%");t.data&&L.forEach(function(n,s){var f=-1;n.style.width=i,s<=a?(d(n),a==s&&(n.style[e.attr]=0,r.push(u(p,{})),r.push(u(p,{})),r.push(u(p,{})),t.data.forEach(function(t,n){var a=o({},t);a[e.text]=a[e.text],r.push(u(p,a))}),r.push(u(p,{})),r.push(u(p,{})),r.push(u(p,{})),n.innerHTML=r.join(""),l(t.data,function(n,a){if(t.value==a[e.value])return f=n,!1}),f>-1&&(D.getOptWidth(n),N.scrWidth&&(n.style[e.attr]=-f*N.scrWidth+"px")))):(c(n),n.innerHTML="")})},U={ajax:function(t,n){if(e.data&&e.data.length){var a,r=[];if(!t)return;if((a=t.index)<1)return r=e.data,t.data=r,void n(t);!function t(n){if(a-1==n.index){for(var i=0,o=n.data.length;i<o;i++)if(n.data[i][e.value]==n.value){r=n.data[i].children;break}}else t(n.children)}(z),t.data=r,n(t)}},show:function(){d(y),F(z),P.classList.add("areaSelectFocus")},hide:function(){c(y),P.classList.remove("areaSelectFocus"),h.forEach(function(t){t()})},clear:function(){},onChange:function(t){i.push(t)},onCancel:function(t){h.push(t)},onSubmit:function(t){x.push(t)}};j.forEach(function(t,e){U["get"+I(t.id)]=function(){return t.value||""},c(t),P.appendChild(t),w.appendChild(L[e])});var Y=0,z={data:[],index:Y,parentID:"",children:null,value:j[Y].value},_=function(){var t,n=[];t=function(a){if(j[a.index]&&a.value&&a.data&&a.data.length){for(var r=a.data,i=0,o=r.length;i<o;i++)if(r[i][e.value]==a.value){j[a.index].value==a.value&&n.push(r[i][e.text]);break}a.children&&t(a.children)}},t(z),H.innerHTML=n.length&&j[0].value?n.join("<i>/</i>"):"<font>"+e.defaultText+"</font>"},A=function(){!function t(e){if(!e.data||!e.data.length||!j[e.index]){return void function t(e){j[e.index]&&(j[e.index].value="",e.data=[],e.children&&t(e.children))}(e)}j[e.index].value=e.value,e.children&&t(e.children)}(z)},B=function(){!function t(e){j[e.index]&&(e.value=j[e.index].value,e.children&&t(e.children))}(z)},F=function t(n,a){U.ajax(n,function(n){if(n.data&&n.data.length&&L[n.index]){!n.value&&(n.value=n.data[0][e.value]),O(n);var r=n.children;n.children?(r.parentID=n.value,t(n.children,a)):a&&a()}})};return function t(e){if(j[Y+1]){var n={index:++Y,parentID:e.value,value:j[Y].value};e.children=n,t(n)}}(z),F(z,function(){_()}),D.addStartHooks(function(t,e,a){var r,i=0,o=n.body;r=a.target||a.srcElement;for(var l,d,c;r&&r!=o;){if(1==r.nodeType){if(i++>6)return;c=(r.className||"").split(" "),T("l-list",c)>-1?l=r:T("l-body",c)>-1&&(d=r)}r=r.parentNode}e.content=l&&d?l:null}),D.addMoveHooks(function(t,e,n){var a,r;a=t.endPageX-t.startPageX,r=t.startX+a,a>0?r>0&&(t.endPageX-=r/1.1):r<-t.maxScrWidth&&(t.endPageX+=(Math.abs(r)-t.maxScrWidth)/1.1)}),D.addStopHooks(function(t,e,n){var a,r=0,o=0,l=0;if(r=t.endPageX-t.startPageX,Math.abs(r)<e.resetWidth)k(e.content),E(e.content,e.attr,t.startX);else{e.isSpring&&(o=Math.abs(r)/(t.endTime-t.startTime),l=o*e.time*e.drag),r>0?(r+=l,e.moveInt&&(r=Math.ceil(Math.abs(r)/t.scrWidth)*t.scrWidth),(a=t.startX+r)>0&&(a=0)):(r-=l,e.moveInt&&(r=-Math.ceil(Math.abs(r)/t.scrWidth)*t.scrWidth),(a=t.startX+r)<=-t.maxScrWidth&&(a=-t.maxScrWidth)),k(e.content);var d=e.content;E(e.content,e.attr,a,500,function(){var n=m(d,"previousSibling").length,a=Math.abs(parseInt(d.style[e.attr]||0))/t.scrWidth;a=Math.round(a);var r,o={};r=function(t){if(t.index>n&&(t.value=""),t.index==n){o=t,o.value=o.data[a][e.value];var i=o.children;i&&(i.parentID=o.value)}t.children&&r(t.children)},r(z),o.children&&F(o.children),i.forEach(function(t){t()})})}}),U}}if(!t.CY&&(t.CY={}),t.CY.areaUtil)return t.CY.areaUtil;var n=document,a=function(t,e,n){e.split(" ").forEach(function(e){t.addEventListener(e,n,!1)})};(function(t){(Math.random()+"").slice(9)})("areaUtil");var r=function(t,e){return t&&t instanceof Object?t:t?(e||document).querySelector(t):null},i=function(t){return Object.prototype.toString.call(t).split(/\s(\w+)/)[1].toLowerCase()},o=function t(e,n){for(var a in n)n.hasOwnProperty(a)&&("object"!=i(n[a])?void 0!=n[a]&&(e[a]=n[a]):e[a]=t(e[a]||{},n[a]));return e},l=function(t,e){t=t||[];for(var n=0,a=t.length;n<a&&0!=e.call(t[n],n,t[n]);n++);},d=function(t){o(t.style,{display:"block"})},c=function(t){o(t.style,{display:"none"})},u=function(t,e){return e&&"object"==i(e)?t.replace(/\{([^{}]+)\}/g,function(t,n){var a=e[n];return void 0!==a?""+a:""}):t.toString()},s=[],p=[],f=[];s.push('<div class="l-head">'),s.push('\t\t<div class="l-btn l-cancel">取消</div>'),s.push('\t\t<div class="l-btn l-submit">确定</div>'),s.push("</div>"),s.push('<div class="l-body"></div>'),p.push('<div class="l-items">{text}</div>'),f.push('<div class="areaInp"><font>----</font></div>'),f.push('<div class="iIcon"></div>'),s=s.join(""),p=p.join(""),f=f.join("");var h,v=function(){var t=[];t.push(".areaSelect{width:280px;height:28px;position:relative;border:1px solid #ccc;margin-bottom:-1px;cursor:pointer;background-color:#fff;z-index:1;-moz-box-shadow:1px 1px 1px #E6E1E6 inset;-webkit-box-shadow:1px 1px 1px #E6E1E6 inset;box-shadow:1px 1px 1px #E6E1E6 inset}"),t.push(".areaSelect .areaInp{line-height:27px;overflow:hidden;margin:0 20px 0 8px;_margin-left:0px;white-space:nowrap;text-overflow:ellipsis;*+text-indent:8px;color:#333}"),t.push(".areaSelect .areaInp font{color:#999}"),t.push(".areaSelect .areaInp i{margin:0 2px;font-weight:bold}"),t.push(".areaSelect .iIcon{position:absolute;width: 24px;height:25px;right:1px;top:1px;padding:0px;background-color:#fff;}"),t.push('.areaSelect .iIcon:after{content:" ";position:absolute;transition:transform 100ms;color:#dbdbdb;transform:rotate(497deg);border-top:2px solid #999;border-right:2px solid #999;width:8px;height:8px;top:50%;left:50%;margin:-8px 0 0 -5px}'),t.push(".areaSelectFocus.areaSelect .iIcon:after{transform:rotate(315deg);margin:-3px 0 0 -5px}"),t.push(".l-area{position:fixed;left:0;right:0;bottom: 0;z-index:999;background-color:#eee;border-top:solid 1px #ccc;box-shadow:0px -3px 5px 0px rgba(0,0,0,0.1);}"),t.push(".l-area .l-head{overflow:hidden;padding:6px 10px;background-color:#eee;border-bottom: solid 1px #ddd;}"),t.push(".l-area .l-head .l-btn{text-align:center;white-space:nowrap;color:#333;border:1px solid #ccc;border-radius:6px;display:inline-block;padding:3px 10px;font-size:12px}"),t.push(".l-area .l-head .l-cancel{float:left;background-color:#fff}"),t.push(".l-area .l-head .l-submit{float:right;border:#d3b669;color:#fff;background:#d3b669}"),t.push(".l-area .l-body{transform-style:preserve-3d;transform:rotateX(-25deg) translateZ(4px);display:flex;height:245px;overflow:hidden;text-align:center;background-color:#ddd;position:relative;padding:0 10px;-webkit-mask-box-image:-webkit-linear-gradient(bottom,transparent,transparent 4%,#fff 20%,#fff 80%,transparent 100%,transparent)}"),t.push('.l-area .l-body:before{position:absolute;content:" ";border-top:1px solid rgba(0,0,0,0.1);left:0;right:0;height:1px;top: 104px;}'),t.push('.l-area .l-body:after{position:absolute;content:" ";background-color:rgba(0,0,0,0.1);left:0;right:0;height:1px;top: 140px;}'),t.push('.l-area .l-body .l-list{width:33%;font-size:16px;font-family:"Helvetica Neue","Helvetica","Arial","sans-serif"}'),t.push(".l-area .l-body .l-list .l-items{height:35px;line-height:35px;overflow: hidden;text-overflow:ellipsis;white-space: nowrap;padding: 0 5px;}");var e=n.createElement("style");e.type="text/css",e.innerHTML=t.join(""),n.getElementsByTagName("head")[0].appendChild(e),v=function(){}},x=function(e,n){return t.getComputedStyle?t.getComputedStyle(e,null)[n]:e.currentStyle[n]},g=function(t,e){t=n.createElement(t);for(var a in e)e.hasOwnProperty(a)&&("style"==a?o(t.style,e[a]):t[a]=e[a]);return t},m=function(t,e){if(!t)return[];for(var n=[],a=t[e];a&&a!=document;)1==a.nodeType&&n.push(a),a=a[e];return n},b=function(t){var e=/Android|webOS|iphone|ipod|ipad|BlackBerry/i.test(navigator.userAgent),i="mousedown",l="mousemove",d="mouseup";if(e&&(i="touchstart",l="touchmove",d="touchend"),t=o({drag:.1,time:1e3,attr:"top",elem:"",content:"",resetWidth:10},t||{}),t.elem=r(t.elem),t.elem){var c,u=[],s=[],p=[],f={startPageX:0,endPageX:0,startX:0,startTime:0,endTime:0,winWidth:0,maxScrWidth:0,scrWidth:0},h="left"==t.attr,v=function(t){var e="offset"+(h?"Width":"Height");return function(t){return t[e]}}(),g=function(t){var n=h?"pageX":"pageY";return e?function(t){return t.changedTouches[0][n]}:function(t){return t[n]}}(),m=!1,b=function(){return+new Date},y=function(e){var n;e.style.position="relative",c=e.children,f.winWidth=v(t.elem),f.scrWidth=v(c[0]),n=Math.max(v(e),c.length*f.scrWidth),f.maxScrWidth=n-f.winWidth};return a(n,i,function(e){u.forEach(function(n){n(f,t,e)}),t.content&&(m=!1,f.startTime=b(),f.startPageX=g(e),y(t.content),f.startX=parseFloat(x(t.content,t.attr)||0))}),a(n,l,function(e){if(t.content){m=!0,e.preventDefault(),f.endPageX=g(e),s.forEach(function(n){n(f,t,e)});var n={},a=0;a=f.endPageX-f.startPageX,n[t.attr]=f.startX+a+"px",o(t.content.style,n)}}),a(n,d,function(e){t.content&&m&&(e.preventDefault(),f.endTime=b(),f.endPageX=g(e),p.forEach(function(n){n(f,t,e)}),t.content=null)}),{getOptWidth:function(t){y(t)},params:t,__params:f,addStartHooks:function(t){u.push(t)},addMoveHooks:function(t){s.push(t)},addStopHooks:function(t){p.push(t)}}}},y=[],w=function(t,e,n,a){return t==a?e+n:n*(1-Math.pow(2,-10*t/a))+e},S=function(t,e,n,a){return n*t/a+e},k=function(t){for(var e=y.length-1;e>=0;e--)y[e].elem==t&&(y[e].callback(),y.splice(e,1))},E=function(t,e,n,a,r,i){var o,l=window.getComputedStyle(t,null),d=parseInt(l.getPropertyValue(e.replace(/([A-Z])/g,"-$1").toLowerCase()))||0,c=0,u=a||500,s=+new Date,p=Math.abs(d-n),f=n>d,v=function(n){if(!(c<u)||n)return t.style[e]=(f?d+p:d-p)+"px",r&&r(),!0;c=+new Date-s,o=i?S(c,0,p,u):w(c,0,p,u),t.style[e]=(f?d+o:d-o)+"px"};if(v.elem=t,v.callback=function(){return r&&r(),!0},y&&y.length)return y.push(v);y=[v],clearInterval(h),h=setInterval(function(){for(var t=y.length-1;t>=0;t--)y[t]()&&y.splice(t,1)},15)},W={id:"",value:""},M=function t(e){var n=[],a=function(){return"tem"+ ++t.id};return t.id=t.id||0,e.forEach(function(t,e){var i=r(t.id);i||(i=g("input"),i.id=i.name=t.id||a(),i.value=t.value||""),!i.name&&(i.name=i.id||a()),t.value&&(i.value=t.value),n.push(i)}),n},X=function(t){var e=[];return t.forEach(function(t,n){e.push(g("div",{type:"hidden",className:"l-list"}))}),e},I=function(t){return(t||"").replace(/(\w)/,function(t){return t.toUpperCase()})},T=function(t,e){for(var n=0,a=e.length;n<a;n++)if(e[n]===t)return n;return-1};return t.CY.areaUtil=e,e});