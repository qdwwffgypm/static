!function(a,b){if("undefined"!=typeof module)require("../libs/dialog"),require("./ajaxUtil"),module.exports=b(a);else if(b(a),"function"==typeof define&&(define.amd||define.cmd)){var c="//"+(!/ppppoints.com/.test(document.domain)?"j.changyoyo.com":"j.ppppoints.com")+"/static/js/";requirejs.config({paths:{dialog:c+"libs/dialog",ajaxUtil:c+"utils/ajaxUtil"}}),define("sendSmsUtil",["dialog","ajaxUtil"],function(){return b(a)})}}(window||this,function(a){var b,c,d,e,f,g,h;return!a.CY&&(a.CY={}),a.CY.checkUtil?a.CY.checkUtil:(b=function(a,b,c){b.split(" ").forEach(function(b){a.addEventListener(b,c,!1)})},c=function(a,b){"array"!=e(b)&&(b=[b]);for(var c=0;c<b.length;c++)a=a.replace(new RegExp("\\{"+c+"\\}","g"),b[c]);return a},d=function(a,b){return a&&a instanceof Object?a:a?(b||document).querySelector(a):null},e=function(a){return Object.prototype.toString.call(a).split(/\s(\w+)/)[1].toLowerCase()},f=function(a,b){for(var c in b)b.hasOwnProperty(c)&&("object"!=e(b[c])?void 0!=b[c]&&(a[c]=b[c]):a[c]=f(a[c]||{},b[c]));return a},g=function(){var a={phoneID:"",btnID:"",imgCodeId:"",time:60,downText:"{0}秒后重新发送验证码",disabledCss:"disabled",ajaxType:"ajaxUtil",ajaxUrl:"/pointgate/activityRegister/sendAuthCodeV2",ajaxData:{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:{}},beforeSend:function(){},onAfter:function(){}};return function(e){var g,h,i,j,k,m,l,n,o;return e=f(f({},a),e||{}),g=d(e.phoneID),h=d(e.btnID),i=d(e.imgCodeId),j="input"==h.tagName.toLowerCase(),k=j?h.value:h.innerHTML,l=!1,n=function(a){h[j?"value":"innerHTML"]=a},o={params:e,setDisabled:function(a){l=!!a},countdown:function(){clearInterval(m),h.classList.add(e.disabledCss);var a=e.time;m=setInterval(function(){return 0>a?(h.classList.remove(e.disabledCss),n(k),clearInterval(m),m=null,void 0):(n(c(e.downText,a--)),void 0)},1e3)},setAjaxBody:function(a){var b=e.ajaxData;return b.body=f(b.body,a),this},send:function(){var b,a=this;l||(b=function(){var c=function(b){e.onAfter.call(a,b),"0000"==b.respCode?a.countdown():CY.ui.toast(b.respMsg)},d=g.value,h=i?i.value:"",j=f({body:{phone:d,imgcode:h}},e.ajaxData);l||0==e.beforeSend.call(a,j.body,e)||("ajaxUtil"==e.ajaxType?CY.ajaxUtil.loadData(e.ajaxUrl,j).then(function(a){c(a)}):CY.ajax(e.ajaxUrl,j).then(function(a){c(a)}))},b())}},h&&b(h,"click",function(){!m&&o.send()}),o}}(),h=function(){var a={elemID:"",ajaxUrl:"/pointgate/Validate/queryPicValidate",ajaxData:{},onChange:function(){}};return function(c){var e,g,h,i;return c=f(f({},a),c),e=[],g=d(c.elemID),b(g,"click",function(){i.refresh()}),e.push(c.onChange),h={},i={getCode:function(){return h},updateImg:function(a){g.src=a},change:function(a){e.push(a)},refresh:function(){var b,a=this;b=function(){function d(){function a(){return(0|65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+a()+a()+a()+a()+a()+a()}var f=c.ajaxUrl,g=d(),i=(new Date).valueOf();f+=(f.match(/\?/)?"&":"?")+"timestamp="+i+"&round="+g,h={url:f,key:g},a.updateImg(h.url),e.forEach(function(b){b.call(a,h)})},b()}},setTimeout(function(){i.refresh()},0),i}}(),a.CY.checkUtil={sms:g,gverify:h},a.CY.checkUtil)});