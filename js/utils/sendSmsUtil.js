!function(a,b){if("undefined"!=typeof module)require("../common/td"),require("../libs/dialog"),require("./ajaxUtil"),module.exports=b(a);else if(b(a),"function"==typeof define&&(define.amd||define.cmd)){var c="//"+(!/ppppoints.com/.test(document.domain)?"j.changyoyo.com":"j.ppppoints.com")+"/static/js/";requirejs.config({paths:{td:c+"common/td",dialog:c+"libs/dialog",ajaxUtil:c+"utils/ajaxUtil"}}),define("sendSmsUtil",["td","dialog","ajaxUtil"],function(){return b(a)})}}(window||this,function(a){var b,c,d,e,f,g,h;return!a.CY&&(a.CY={}),a.CY.sendSmsUtil?a.CY.sendSmsUtil:(b=function(a,b,c){b.split(" ").forEach(function(b){a.addEventListener(b,c,!1)})},c=function(a,b){return a&&a instanceof Object?a:a?(b||document).querySelector(a):null},d=function(a){return Object.prototype.toString.call(a).split(/\s(\w+)/)[1].toLowerCase()},e=function(a,b){for(var c in b)b.hasOwnProperty(c)&&("object"!=d(b[c])?void 0!=b[c]&&(a[c]=b[c]):a[c]=e(a[c]||{},b[c]));return a},f=function(a,b){CY.ajaxUtil.loadData("/pointgate/activityRegister/getSliderToken",{headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST",body:a||{},success:function(a){b(a.data)},error:function(a){CY.ui.toast(a.respMsg)}})},g=function(a){var h,b=e({btnID:null,time:60,text:"{0}秒后重发",css:"disabled",callback:function(){}},a||{}),d=c(b.btnID),f="input"==d.tagName.toLowerCase(),g=f?d.value:d.innerHTML,i=function(a){d[f?"value":"innerHTML"]=a};d.classList.contains(b.css)||(d.classList.add(b.css),h=setInterval(function(){return b.time<0?(d.classList.remove(b.css),i(g),clearInterval(h),b.callback(),void 0):(i(b.text.replace(new RegExp("\\{0\\}","g"),b.time--)),void 0)},1e3))},h=function(){var a={phoneID:"",btnID:"",ajaxType:"ajaxUtil",ajaxUrl:"/pointgate/activityRegister/sendAuthCodeV3",ajaxData:{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:{}},beforeSend:function(){},onAfter:function(){}};return function(d){var j,k,l,m,h=!1,i=!1;return d=e(e({},a),d||{}),j=c(d.phoneID),k=c(d.btnID),l={params:d,setDisabled:function(a){i=!!a},send:function(){var b,a=this;i||(b=function(){var c=function(b){d.onAfter.call(a,b),"0000"==b.respCode?(h=!0,g(e(d.downParams||{},{btnID:k,callback:function(){h=!1}}))):CY.ui.toast(b.respMsg)},i=j.value.trim(),l=e(d.ajaxData,{body:{mobileid:i}});return/^1\d{10,10}$/.test(i)?(0!=d.beforeSend.call(a,l.body,d)&&f({flag:0,mobileId:i},function(a){a&&(_fmOpt.triggerCaptcha(a),_fmOpt.onSuccess=function(a){l.body.activityCode=spm.util.getQueryValue("activityCode"),l.body.channelSource=spm.getSource(),l.body.sliderFingerprint=window._fmOpt.getinfo(),l.body.validateToken=encodeURIComponent(a),"ajaxUtil"==d.ajaxType?CY.ajaxUtil.loadData(d.ajaxUrl,l).then(function(a){c(a)}):CY.ajax(d.ajaxUrl,l).then(function(a){c(a)})})}),void 0):(CY.ui.toast("手机格式不对！"),void 0)},b())}},m=!1,k&&b(k,"click",function(){m||(!h&&(m=!0)&&l.send(),setTimeout(function(){m=!1},700))}),l}}(),a.CY.sendSmsUtil=h,h)});